<!--
 * @Author: your name
 * @Date: 2019-11-12 22:12:10
 * @LastEditTime: 2020-08-21 11:00:36
 * @LastEditors: your name
 * @Description: In User Settings Edit
 * @FilePath: \github\shell 编程实战（高级编程）\shell 高级编程.md
--> 
---
title: shell 高级编程
tags: 学习
notebook: shell
---
# `shell`高级编程
## 1.`Shell`脚本自动化管理系统的必备基础
* 1.`vi/vim`编辑器的熟练使用，`SSH`终端及“`.vimrc`”的设置等等需要熟悉了。
* 2.命令基础：`Linux`的150个常用命令的熟练使用
* 3.`linux`正则表达式以及三剑客（`grep、sed、awk`）要熟练了。
* 4.常见`linux`网络服务部署、优化及排错。例如：`crond,nfs,rsync,inotify,lanmp,sersync,ssh,memcached,mysql`等。
  
## 2.`shell`
* `shell`是一个命令解释器，它在操作系统的最外层，负责直接与用户对话，把用户的输入解释个操作系统，并处理各种各样的操作系统的输出结果，输出到屏幕返回给用户。
![1](https://ae01.alicdn.com/kf/H7afbd1b555db4aeb890aa50c230532d58.png)

## 3.`shell` 脚本
* 1.由命令、变量和流程控制语句的组成
* 2.编写`shell`要学会类似打游戏过关的环节：
  * 1.第一关 必须是`root`才能执行脚本，否则退出。
  * 2.第二关 成功切换目录（`cd /var/log`）,否则退出。
  * 3.第三关 清理日志（`cat /dev/null > messages`）,清理成功，在输出。
  * 4.第四关 通关了。。。（`echo`输出）
  
## 4.`shell`脚本在运维工作中的作用地位
* `shel`脚本很擅长处理纯文本类型的数据，而`linux`系统中几乎所有的配置文件、日志文件（如`nfs、rsync、httpd、nginx、lvs等`）、多数启动文件都是纯文本类型的文件。因此，如果学好shell脚本语言，就可以利用它在linux系统中发挥巨大的作用。

## 5.`shell`脚本语言的种类
* `Bourne shell: sh,ksh,bash`
* `C shell: csh,tsch`
* 查看系统支持的`shell`
```shell
    # cat /etc/shells
```

## 6.文件测试表达式
* 常用的文件测试操作符

  常用的文件测试操作符 | 说明
  -|-
  `-f` 文件，英文`file`|文件存在并且为普通文件则真，即测试表达式成立。
  `-d` 文件，英文`directory`|文件存在且为目录文件则真，即测试表达式成立。
  `-s` 文件，英文`size`|文件存在且文件大小不为`0`则真，即测试表示成立。
  `-e` 文件，英文`exist`|文件存在则真，即测试表达式成立，只要有文件就行，要区别`-f`
  `-r` 文件，英文`read`|文件存在且可读则真，即测试表达式成立。
  `-w` 文件，英文`write`|文件存在且可写则真，即测试表达式成立。
  `-x` 文件，英文`executable`|文件存在且可执行则真，即测试表达式成立。
  `-L` 文件，英文`link`|文件存在且为链接文件则真，即测试表达式成立。
  `f1 -nt f2`,英文`newer than`|文件`f1`比文件`f2`新则真，即测试表达式成立，根据文件修改时间计算。
  `f1 -ot f2`,英文`older than`|文件`f1`比文件`f2`旧则真，即测试表答是成立，根据文件修改时间计算。
* 这些操作符对于`[[]]`、`[]`、`test`几乎是通用的
* 查看文件测试文档
```shell
    # man test
```
* 可以使用条件表达式，大括号的用法，当条件不成立时就会执行大括号内的所有命令内容，如果写在一行里面

## 7.字符串测试表达式
* 常用的字符串测试操作符

    常用的字符串测试操作符|说明
    -|-
    `-z`"字符串"|若串长度为0则真，`-z`可以理解为`zero`。
    `-n`"字符串"|若串长度不为0则真，`-n`可以理解为`no zero`。
    "串1" `=` "串2"|若串1等于串2则真，可使用“`==`”代替“`=`”。
    "串1" `!=` "串2"|串1等于串2则真，可使用“`!==`”代替“`!=`”。

* 以上表格中的字符串测试操作符号务必要用`""`引起来。
* 比较符号的两端必须有空格。

## 8.整数二元比较操作符
* 常用整数二元比较操作符
  
  在`[]`以及`test`中使用的比较符|在`(())`和`[[]]`中的使用的比较符|说明
  -|-|-
  `-eq`|`==`或`=`|`equal`的缩写，相等
  `-ne`|`!=`|`not equal`的缩写，不相等
  `-gt`|`>`|大于`greater than`
  `-ge`|`>=`|大于等于`greater equal`
  `-lt`|`<`|小于`less than`
  `-le`|`<=`|小于等于`less equal`

* `=`和`!=`在`[]`中使用不需要转义，包含`>`和`<`的符号在`[]`中使用需要转义，对于数字不转义的结果未必会报错，但是结果可能不会对。
* `[[]]`用`-eq`等的写法也是对的，`[[]]`用`>`写法也可能不对，只比较第一位，逻辑结果不对
* *推荐使用`[]`用`-eq`*