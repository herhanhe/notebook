# kvm使用
* 查看CPU虚拟化支持
  * BIOS信息中查看
  * 命令查看：`egrep ' (vmx|svm) '/prov/CPUinfo`
* 安装kvm
  * 使用PXE+kickstart 批量安装
```bash
    # Kickstart file automatically generated by anaconda
    # 系统安装自动生成的kickstart文件install
    url --url=http://10.10.10.1/system/CentOS76
    。。。
```

# kvm cpu、内存虚拟化技术与应用场景

* KVM虚拟机CPU的软件调优首先需要对NUMA技术有一定的了解，调优的主要手段就是虚拟机对物理机CPU逻辑核的手工绑定

* 解决多CPU共同工作的技术方案
  * SMP技术
    * 即多个CPU通过一个总线访问存储器
    * SMP系统有时也被称为一致内存访问（UMA）结构体系。一致性意指无论在什么时候，处理器只能为内存的每个数据保持或共享唯一一个数值。
    * 架构 多CPU的SMP架构
  ![kvm-6](https://heh-1300576495.cos.ap-chengdu.myqcloud.com/assets/kvm/kvm-6.jpg)
    * 缺点：扩展性有限，因为在存储器接口达到饱和的时候，增加处理器并不能获得更高的性能，因此SMP方式支持的CPU个数有限。
  * MPP模式
    * 分布式存储器模式，能够将更多的处理器纳入一个系统的存储器。
    * 分布式存储器模式具有多个节点，每个节点都有自己的存储器，可以配置SMP模式，也可以配置为非SMP模式。单个的节点项目连接起来就形成了一个总系统。
    * MPP可以近似理解成一个SMP的横向扩展集群
    * MPP一般要依靠软件实现。
  * NUMA技术
    * 每个处理器有自己的存储器，每个处理器也可以访问别得处理器的存储器。
    * 架构 多CPU的NUMA架构
  ![kvm-7](https://heh-1300576495.cos.ap-chengdu.myqcloud.com/assets/kvm/kvm-7.jpg)
    * 早期的商业方案NUMA-Q,多核NUMA CPU架构
  ![kvm-8](https://heh-1300576495.cos.ap-chengdu.myqcloud.com/assets/kvm/kvm-8.jpg)

* CPU的Nested特性使用也是非常有意思的一个特性，KVM虚拟机的嵌套在理论上可以无线层地嵌套下去，只要物理机的性能足够。

* 内存方面的调优手段主要是KSM，即相同内存页合并，内存气球技术及大页内存的使用。